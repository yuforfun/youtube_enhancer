# YouTube 雙語字幕工具

一個專為日文影片開發的小工具，讓你可以在 YouTube 上同時觀看原文和中文翻譯字幕，或者只顯示其中一種。

這個工具包含兩個部分：一個瀏覽器擴充功能（前端）和一個用來翻譯的小程式（後端）。你不需要懂程式，只需要簡單幾個步驟就可以開始使用！

---

### ✨ 主要功能

* **日文/中文雙語字幕**：自動抓取 YouTube 上的日文字幕，並將其翻譯成中文。
* **靈活切換**：可以自由選擇「日文 + 中文」、「僅日文」或「僅中文」三種顯示模式。
* **自訂翻譯內容**：你可以自行調整翻譯時使用的提示詞（Prompt），讓翻譯更符合你的需求。

---

### 📥 如何安裝與使用

請依照以下三個簡單步驟操作：

#### **步驟一：下載檔案

1. 前往 [**Release 頁面**](https://github.com/yuforfun/youtube_enhancer/tree/master/release_files) 下載最新的 `YouTube_Subtitle_Backend_vX.X.X.exe`、`config.json.example`、`YouTube_Subtitle_Extension_vX.X.X.zip` 三個檔案以及兩張圖片(server_icon)。

    方法一：下載單個檔案
    - 在 GitHub 專案頁面上，找到你想下載的檔案。
    - 點擊檔案名稱進入檔案內容頁面。
    - 在右上角會看到一個「Raw」或「Download」按鈕。
    - 點擊右鍵選擇「另存連結為...」或直接點擊按鈕，就可以將檔案下載到你的電腦中。

    方法二：下載整個[專案壓縮檔](https://github.com/yuforfun/youtube_enhancer/tree/master)
    - 如果你想下載整個專案，包含所有程式碼和資料夾結構，可以下載一個完整的 .zip 壓縮檔。
    - 在 GitHub 專案的首頁，找到右上方的綠色按鈕，上面通常寫著「Code」。
    - 點擊這個按鈕。
    - 在下拉式選單中，選擇「Download ZIP」。
    - 這樣，GitHub 就會自動將整個專案打包成一個 .zip 壓縮檔，你下載後解壓縮就可以使用了。

2.  將release_files的檔案放到一個你找得到的地方，例如桌面。


#### **步驟二：設定 Gemini API Key**

1.  **申請 API Key**：前往 [**Google AI Studio 網站**](https://aistudio.google.com/app/apikey) 申請你的 Gemini API Key。這個服務提供免費額度。
2.  **編輯 `config.json` 檔案**：找到你下載的 `config.json.example` 重新命名為`config.json`檔案，用 Notepad++ 或記事本打開它。
3.  **填入 API Key**：將你的 API Key 複製並貼到 `config.json` 檔案中的 `在這裡填入您的金鑰` 的位置。

```json
{
    "GEMINI_API_KEYS": [
        {"name": "Key 1", "key": "在這裡填入您的金鑰"},
        {"name": "Key 2", "key": "這個檔案只是範例，請重新命名為 config.json"}
    ],
    "MODEL_PREFERENCE": [
        "gemini-2.5-flash",
        "gemini-2.5-flash-lite",
        "gemini-2.5-pro",
        "gemini-2.0-flash-lite",
        "gemini-2.0-flash"
    ],
    "GEMINI_PROMPT_TEMPLATE_LINES": [
        "你是一位頂尖的繁體中文譯者與日文校對專家，專為台灣的粉絲翻譯 YouTube 影片的自動字幕。",
        "你收到的日文原文雖然大多正確，但仍可能包含 ASR 造成的錯字或專有名詞錯誤。",
        "",
        "**你的核心任務:**",
        "請發揮你的推理能力，理解原文的真實意圖，並直接翻譯成最自然、口語化的繁體中文。",
        "",
        "**翻譯指南:**",
        "- **專有名詞**: 翻譯時，人名經常被誤判請不要被日文漢字誤導，務必遵循以下對照規則：",
        "  - 「しそん じゅん」應翻譯為「志尊 淳」。",
		"  - 「さとう たける」應翻譯為「佐藤 健」。",
        "  - 其他常見人名~~~~~~",
        " 請注意格式，每一行頭尾都有雙引號，結尾要有,，最後兩句不要刪掉，中間想怎麼改都可以，但是不要太長喔",
        "**請處理以下 JSON 陣列中的日文句子:**",
        "{json_input_text}"
    ]
}
```

#### Google Gemini 模型比較表

| 模型名稱 | RPD (每日請求上限) | RPM (每分鐘請求上限) | 效能/複雜度 | 建議 |
| :--- | :---: | :---: | :---: | :--- |
| **gemini-2.5-pro** | 100 | 5 | **優異** | 適合需要高品質、複雜推理的任務，但因請求限制較低，不適合高頻率的應用。 |
| **gemini-2.5-flash** | 250 | 10 | **好** | 在效能與速度之間取得平衡，適合大多數應用場景，例如聊天機器人。 |
| **gemini-2.5-flash-lite** | 1000 | 15 | **中等** | 速度快，最適合需要高頻率、即時回應的任務，如即時翻譯、簡單問答。 |
| **gemini-2.0-flash** | 200 | 15 | **中等** | 速度快，適合需要高頻率請求的任務，效能略遜於 2.5 系列。 |
| **gemini-2.0-flash-lite** | 200 | 30 | **中等** | 速度最快，是五個模型中每分鐘請求數最高的，適合非常高頻率、即時的簡單任務。 |


#### **步驟三：執行後端小程式**

1.  將`YouTube_Subtitle_Backend_vX.X.X.exe`以及修改好的`config.json`還有兩張`server_icon圖片`放在同一個資料夾中。
3.  **直接點兩下執行**這個 `.exe` 檔案。
    * **注意**：首次執行時，Windows 可能會跳出一個警告視窗。這是正常的，因為這個程式不是從官方商店下載的。請選擇「**更多資訊**」，然後點擊「**仍要執行**」。
4.  執行後，你會在右下角看到多出一個灰色小圖示，停留後名稱顯示為`YT字幕增強器後端`。**請不要關閉這個**，只要你想要使用就讓它持續開啟，不需使用的話在圖示上右鍵結束即可。


#### **步驟三：安裝瀏覽器擴充功能（前端）**  

這個工具目前僅支援 **Google Chrome 瀏覽器**。

1.  找到下載好的 `YouTube_Subtitle_Extension_vX.X.X.zip` 壓縮檔。
2.  打開 Chrome 瀏覽器，在網址列輸入 `chrome://extensions`，然後按下 Enter。
3.  在擴充功能頁面的右上角，打開「**開發人員模式**」。
4.  把剛剛下載的壓縮檔(.zip)直接用拖曳的方式拉到擴充功能頁面中間區域
5.  如果一切順利，你應該會在擴充功能列表中看到一個新的工具圖示。

---

### 🎬 如何使用工具

1.  確保 **步驟三** 中的後端程式正在運行。
2.  在 Chrome 中打開一個你想要翻譯的 YouTube 影片。請確定這個影片本身有提供日文字幕。（你可以點擊影片下方的「CC 字幕」按鈕，看看有沒有「日文」選項）。

3. 回到擴充功能的彈出視窗，點擊「啟用翻譯」按鈕。

4. 啟用後，請務必開啟 YouTube 播放器內建的「CC 字幕」功能，並選擇日文字幕。

5. 當你看到日文字幕下方出現 `...`，這代表翻譯程式已經成功接收到字幕並正在翻譯中。
翻譯程式會以每 30 句字幕為一批進行翻譯。`...`就是翻譯中的提示訊息。

6. 你可以選擇繼續觀看影片，當翻譯完成後，翻譯好的中文會直接顯示在日文字幕下方。

7. 你也可以暫停影片，等待所有(或者部分)字幕翻譯完成再繼續觀看。
8. 如果看到「翻譯失敗」：這表示某一批字幕翻譯失敗了。你可以直接用滑鼠點擊那個顯示「翻譯失敗」的字幕，程式會立刻從這一行開始重新進行翻譯。

9. 字幕會被儲存：所有翻譯完成的字幕都會自動儲存在你的瀏覽器中。這表示下次你再看同一部影片時，這些字幕會立刻顯示，不需要再次進行翻譯。

10. 清理暫存：如果你想刪除所有已翻譯的字幕快取，可以在擴充功能的彈出視窗中找到「清除暫存」按鈕來操作。

11. 不建議同時開多個影片：後端程式一次只能處理一個翻譯請求。同時開啟多個影片會讓翻譯交錯進行，導致速度變慢。如果你想預先翻譯多部影片，建議等當前影片全部翻譯完成後，再開啟下一部影片。

---

### 常見問題與疑難排解 (FAQ)
#### Q1：我的翻譯為什麼沒有啟動，或是影片字幕沒有變化？
這通常是最常見的問題。請依照以下步驟檢查：

1. 確認後端程式正在運行：請檢查電腦右下角的系統工具列，確認那個小圖示（後端程式）還在。如果沒有，請重新執行 YouTube_Subtitle_Backend_vX.X.X.exe。

2. 確認影片有日文字幕：本工具需要 YouTube 影片本身提供官方或創作者上傳的日文字幕。如果影片本身沒有日文字幕選項，工具將無法翻譯。你可以點擊 YouTube 播放器下方的「字幕」按鈕，看看是否有「日文」選項。

3. 檢查 Gemini API Key：請確認 config.json 檔案中的 api_key 是否正確且沒有多餘的空格。如果你不確定，可以前往 Google AI Studio 重新申請一個 API Key。

#### Q2：如果後端程式在翻譯過程中被中斷（例如關閉或當機）會發生什麼事？
如果你在翻譯進行中關閉了後端程式，擴充功能會因為無法連線而停止翻譯。此時，影片中的字幕可能會一直顯示 ... 或「翻譯失敗」。

你只需要重新開啟後端程式（YouTube_Subtitle_Backend_vX.X.X.exe），然後回到 YouTube 頁面，點擊「翻譯失敗」的字幕，翻譯就會從該句重新開始。

#### Q3：為什麼我開啟多個 YouTube 頁面時，翻譯會變得卡頓或不順暢？
你的後端程式一次只能處理一個翻譯請求。如果同時開啟多個影片並啟用翻譯，後端會交錯處理這些請求，導致每個影片的翻譯進度都會變慢。

建議作法：如果你想預先翻譯多部影片，請等待一部影片翻譯完成後，再開啟下一部影片。

#### Q4：字幕翻譯成功後，會被存放在哪裡？
翻譯完成的字幕會儲存在你瀏覽器的本機快取（Local Storage）中。這代表即使你關閉瀏覽器，下次再開啟這個影片時，已經翻譯過的字幕會直接從快取中載入，不需要再次進行翻譯。

如果你想要清除所有已翻譯的字幕快取，可以在擴充功能的彈出視窗中找到「清除暫存」按鈕來操作。

#### Q5：我看到「翻譯失敗」的訊息，該怎麼辦？
這個訊息通常表示翻譯過程中發生了錯誤，可能原因包括：

-   後端程式未運行。

-   網路連線不穩定。

-   Gemini API 請求失敗（例如超過了每日或每分鐘的請求限制）。

你可以直接點擊這個「翻譯失敗」的字幕，程式會立刻重新嘗試翻譯該批字幕。

#### Q6：我是一個開發者，要如何進行更詳細的除錯？
如果上述方法都無法解決問題，你可以使用瀏覽器的開發者工具來進行除錯：

在 YouTube 頁面按 F12 或右鍵點選「檢查」，開啟開發者工具。

切換到「Console (主控台)」頁籤，這裡會顯示程式執行的錯誤訊息。如果你看到紅色的錯誤訊息，可以將其截圖，並在 Issues 頁面 中提出。

切換到「Network (網路)」頁籤，當你點擊「啟用翻譯」時，你可以觀察到對 http://127.0.0.1:5001/api/translate 的請求。如果請求失敗，你會看到紅色的錯誤代碼（例如 404 或 500）。

### 🚀 版本更新日誌

**v1.0.0 (2025/09/24)**
- 初版釋出。

---

### ⚠️ 免責聲明

此工具僅供個人學習與研究使用。

